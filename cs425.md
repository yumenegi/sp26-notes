# CS 425
## 01/21/25
### Overview
- What is a distributed system?
  - Hardware and software components located at networked computers that communicate or coordinate through passing messages
  - A collection of computing elements connected by a network
  - Independent components connected by network and passing messages to achieve a common goal as a single system
- Cascading failures
  - Failure in another computer of the distributed system can render the user's own computer unusable
- Why distributed systems
    - Scalability
    - Compute
    - Reliability/fault tolerance
    - Conquier geographic separation
    - Customize computers for speicifc tasks
### Scaling Example
- One server running both webserver and DB
- Two servers
  - One for server and one for db
  - System is offline twice as often
- Scalable number of front-end web server
  - Stateless
    - If a server crash, can reconnect user to another server
    - Use various policies to map users to front-ends
- Scalable number of dbs
  - Distributed systems code
  - Remains usable even with crash

### Challenges
- **Concurrent execution**
- **Independent failure**
- Autonomous administrationz

### Networked Communications
- **Async**
- **Unreliable**
- Insecure

### Common Goals
- **Consistency**
- Transparency

### How Processes Communicate
- Directly using network sockets
- Subscriber/Publisher
- Distributed share memory
- Differ with the nature of the system

### Communication Channel properties
- Latency (L): Total amount of time between the start of the message transmission to the receiving of the first bit of the message
- Bandwidth (B): Total amount of infromation that can be transmitted over the channel per unit time
  - Total time taken to pass a message is governed by latency and bandwidth of the channel

### Syncronous Distributed Systems
- Known upper and lower bounds on time taken by each step in a process
- Known bounds on messsage passing delays
- Known bounds on clock drift

### Asynchronous
- No bounds on execution speeds
- No bounds on message delay
- No bounds on clock drift

### Real Life Systems
- Most are asynchronous

### Detect a crashed process
- Health check pings
  - Time-outs would imply a crashed process
- Periodic
  - Heartbeats
  - If no heartbeats, dead process

### Periodic Ping
- $\Delta _1$ is the timeout value, host sends pings to slave every $T$ seconds
- If $\Delta _1$ is exceeded and no ack from slave, report crash
  - If synchronous, $\Delta _1 = 2 (\text{max delay})$ 
  - If asynchronous $\Delta _1 = k(\text{max observed round trip time})$
    - $k > 1$ is a reasonable estimate

### Heartbeats
- Slave sends heartbeats to host every $T$ seconds
- $(T+\Delta _2)$ is the timeout value at host
- If $(T+\Delta _2)$ time elapsed since last heartbeat, report slave crashed
- If synchrnous, $\Delta _2 = maxD - minD$, $D=delay$
  - Worst case heartbeat gap of synchronous system can be calculated by taking $t+minD$, the best case receiving time of the first heartbeat at the host, subtracted by $t+T+maxD$, the worst case receiving time of the second heartbeat at the host, where $t$ is the arbitrary time at which the heartbeat is sent
- If async, $\Delta _2 = \text{observed delay}$

### Correctness of Failure Detection
- Characterized by completeness and accuracy
- Completeness
  - Every fail is logged
- Accuracy
  - All detection correspond to actual failed process
- Synchrnous
  - Failure detection via ping-ack and heartbeat is both complete and accurate
- Asynchronous
  - Impossible to achieve both completeness and accuracy
  - Our strategy for ping-ack and heartbeat is complete

### Metric for failure detection
  - Worst case failure detection time
  - **Ping-ack**
    - $T+\Delta _1 - \Delta$ where $\Delta$ is the time taken for the last ping from master to reach slave before slave crashed. $T$ is the time period for pings
    - $t$
      - Master pings
    - $t+\Delta$
      - Slave responds and fails immediately
    - $t+T$
      - Master pings again
    - $t+T+\Delta _1$
      - Time-out and crash detected
    - The system crashes at $t+\Delta$ and the crash is detected at $t+T+\Delta _1$
  - **Heartbeat**
    - $T+\Delta _2 + \Delta$
    - $T+2\times max - min$
    - $t$
      - Slave sends heartbeat and fails immediately
    - $t+\Delta$
      - Master receives heartbeat
    - $t+\Delta+\Delta _1$
      - Master did not receive heartbeat, crash detected
    - Worst case of value $\Delta$ is max network delay and $Delta _1$ is $max-min$
  - Bandwidth
    - Ping-ack
      - 2 messages every $T$
    - Heartbeat 
      - 1 message evert $T$
    - Decreasubg $T$ leads to faster detection but more bandwidth usage
  - Effect of increase $\Delta _1$ and $\Delta _2$
    - Increase accuracy if asynchronous system
    - Leads to longer detection time

### Type of Failure
- **Omission**
  - When a process or a channel fails to perform an action
  - Channel Omission: omitted by channel
  - Send omission: process completes ‘send’ operation, but message does not reach its outgoing message buffer.
  - Receive omission: message reaches the incoming message buffer, but not received by the process. 
### Two Generals Problem
  